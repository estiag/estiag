{"version":3,"file":"js/698.8b5007a6.js","mappings":"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","sources":["webpack://estiag/./src/views/PenbeatPlayer.vue","webpack://estiag/./src/components/penbeatBook.js","webpack://estiag/./src/views/PenbeatPlayer.vue?4fd3"],"sourcesContent":["<template>\r\n  <div id=\"page-content\" class=\"header-static\">\r\n    <div class=\"container\">\r\n      <div class=\"row padding-onlytop-lg center\">\r\n        <div class=\"right-label\">右</div>\r\n        <div class=\"left-label\">左</div>\r\n\r\n        <div class=\"window\">\r\n          <div class=\"right\" ref=\"rightDiv\" :class=\"{disabled:!rightSwitch}\">\r\n            <div class=\"bar\" v-for=\"(bar,indexBar) in right\" :key=\"indexBar\">\r\n              <div\r\n                class=\"beat\"\r\n                v-for=\"(beat,indexBeat) in bar\"\r\n                :key=\"indexBeat\"\r\n                v-bind:class=\"{used:isRightUsed(indexBeat+indexBar*barSize)}\"\r\n              >{{ beat }}</div>\r\n            </div>\r\n          </div>\r\n          <div class=\"left\" ref=\"leftDiv\" :class=\"{disabled:!leftSwitch}\">\r\n            <div class=\"bar\" v-for=\"(bar,indexBar) in left\" :key=\"indexBar\">\r\n              <div\r\n                class=\"beat\"\r\n                v-for=\"(beat,indexBeat) in bar\"\r\n                :key=\"indexBeat\"\r\n                v-bind:class=\"{used:isLeftUsed(indexBeat+indexBar*barSize)}\"\r\n              >{{ beat }}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"row padding-onlytop-lg center\">\r\n        <input @click=\"play\" class=\"btn-alt active\" type=\"button\" value=\"播放\" />\r\n        <input @click=\"stop\" class=\"btn-alt active\" type=\"button\" value=\"暂停\" />\r\n\r\n        <input @click=\"restart\" class=\"btn-alt active\" type=\"button\" value=\"重新开始\" />\r\n        <input @click=\"play1(500)\" class=\"btn-alt active\" type=\"button\" value=\"1\" />\r\n        <input @click=\"play2(500)\" class=\"btn-alt active\" type=\"button\" value=\"2\" />\r\n        <input @click=\"play3(500)\" class=\"btn-alt active\" type=\"button\" value=\"3\" />\r\n        <input @click=\"play4(500)\" class=\"btn-alt active\" type=\"button\" value=\"4\" />\r\n        BPM:\r\n        <input type=\"number\" v-model=\"bpm\" />\r\n        <input id=\"left\" class type=\"checkbox\" v-model=\"leftSwitch\" />\r\n        <label for=\"left\">左</label>\r\n        <input id=\"right\" class type=\"checkbox\" v-model=\"rightSwitch\" />\r\n        <label for=\"right\">右</label>\r\n        <input id=\"metronome\" class type=\"checkbox\" v-model=\"metronomeSwtich\" />\r\n        <label for=\"metronome\">节拍器</label>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { yellow } from '../components/penbeatBook.js'\r\n//定时器时间间隔ms\r\nconst timeInterval = 1\r\nconst musicBar = yellow\r\nlet rightAnimation = ''\r\nlet leftAnimation = ''\r\nlet beatWidth = 80\r\n// 创建 AudioContext 对象\r\nconst audioContext = new (window.AudioContext || window.webkitAudioContext)()\r\n// 创建 GainNode 对象，用于控制音量\r\nconst gainNode = audioContext.createGain()\r\n// 设置 GainNode 的音量\r\ngainNode.gain.value = 0.2\r\nexport default {\r\n  data: function () {\r\n    return {\r\n      leftSwitch: true,\r\n      rightSwitch: true,\r\n      metronomeSwtich: false,\r\n      bpm: musicBar.bpm,\r\n      right: musicBar.right,\r\n      left: musicBar.left,\r\n      leftBeatOffset: beatWidth / 2,\r\n      rightBeatOffset: 0,\r\n      barSize: musicBar.right[0].length,\r\n      beatWidth: beatWidth,\r\n      running: false,\r\n    }\r\n  },\r\n  watch: {},\r\n  computed: {},\r\n  mounted: function () {},\r\n  methods: {\r\n    isLeftUsed: function (index) {\r\n      return Math.ceil(-this.leftBeatOffset / this.beatWidth) >= index + 1\r\n    },\r\n    isRightUsed: function (index) {\r\n      return Math.ceil(-this.rightBeatOffset / this.beatWidth) >= index + 1\r\n    },\r\n    playSingleBeat: function (beat) {\r\n      let vm = this\r\n      let beats = beat.split(' ')\r\n      let duration = 60000 / this.bpm / beats.length\r\n      let step = duration / beats.length\r\n      for (let i = 0; i < beats.length; i++) {\r\n        let subBeatStep = step / (beats[i] + '').length\r\n        for (let j = 0; j < (beats[i] + '').length; j++) {\r\n          let subBeat = (beats[i] + '').split('')[j]\r\n          setTimeout(function () {\r\n            if (subBeat == 0) {\r\n              vm.play0(subBeatStep)\r\n            } else if (subBeat == 1) {\r\n              vm.play1(subBeatStep)\r\n            } else if (subBeat == 2) {\r\n              vm.play2(subBeatStep)\r\n            } else if (subBeat == 3) {\r\n              vm.play3(subBeatStep)\r\n            } else if (subBeat == 4) {\r\n              vm.play4(subBeatStep)\r\n            }\r\n          }, subBeatStep * (i + j))\r\n        }\r\n      }\r\n    },\r\n    playSinWave: function (frequency, duration) {\r\n      // 创建 OscillatorNode 对象，用于生成正弦波\r\n      const oscillator = audioContext.createOscillator()\r\n      // 设置正弦波的频率和类型\r\n      oscillator.frequency.value = frequency // 频率为 3000 Hz\r\n      oscillator.type = 'triangle' // 类型为三角波\r\n      // 将 OscillatorNode 对象连接到 GainNode 对象\r\n      oscillator.connect(gainNode)\r\n      // 将 GainNode 对象连接到 AudioContext 的 destination\r\n      gainNode.connect(audioContext.destination)\r\n      // 开始播放正弦波\r\n      oscillator.start()\r\n      // 停止播放正弦波\r\n      setTimeout(() => {\r\n        oscillator.stop()\r\n      }, duration)\r\n    },\r\n    play0: function (duration) {\r\n      //do nothing\r\n    },\r\n    play1: function (duration) {\r\n      this.playSinWave(120, duration)\r\n    },\r\n    play2: function (duration) {\r\n      this.playSinWave(150, duration)\r\n    },\r\n    play3: function (duration) {\r\n      this.playSinWave(200, duration)\r\n    },\r\n    play4: function (duration) {\r\n      this.playSinWave(250, duration)\r\n    },\r\n    stop: function () {\r\n      this.running = false\r\n      window.cancelAnimationFrame(rightAnimation)\r\n      window.cancelAnimationFrame(leftAnimation)\r\n    },\r\n    restart: function () {\r\n      this.stop()\r\n      this.rightBeatOffset = 0\r\n      this.leftBeatOffset = beatWidth / 2\r\n      this.$refs.rightDiv.style.left = this.rightBeatOffset + 'px'\r\n      this.$refs.leftDiv.style.left = this.leftBeatOffset + 'px'\r\n    },\r\n    play: function () {\r\n      if (this.running) {\r\n        return\r\n      }\r\n      let vm = this\r\n      let leftStartTimestamp,\r\n        rightStartTimestamp,\r\n        leftPreviousTimestamp,\r\n        rightPreviousTimestamp\r\n      let leftLastBeatIndex = -1\r\n      let rightLastBeatIndex = -1\r\n      //歌曲总时长(ms)\r\n      let rightAnimate = function (timestamp) {\r\n        //移动速度(px/ms)\r\n        let speed = ((vm.bpm * timeInterval) / 60000) * vm.beatWidth\r\n        if (!rightStartTimestamp) {\r\n          rightStartTimestamp = timestamp\r\n          rightPreviousTimestamp = timestamp\r\n        }\r\n        let elapsed = timestamp - rightStartTimestamp\r\n        //判断是否需要演奏音符\r\n        if (\r\n          vm.rightSwitch &&\r\n          rightLastBeatIndex < Math.floor(elapsed / (60000 / vm.bpm))\r\n        ) {\r\n          //演奏\r\n          rightLastBeatIndex++\r\n\r\n          vm.playSingleBeat(\r\n            vm.right[Math.floor(rightLastBeatIndex / vm.barSize)][\r\n              rightLastBeatIndex % vm.barSize\r\n            ]\r\n          )\r\n        }\r\n        if (\r\n          !(vm.rightBeatOffset <= -(vm.right.flat(2).length - 1) * vm.beatWidth)\r\n        ) {\r\n          //需要继续演奏\r\n          vm.rightBeatOffset =\r\n            vm.rightBeatOffset - speed * (timestamp - rightPreviousTimestamp)\r\n          vm.$refs.rightDiv.style.left = vm.rightBeatOffset + 'px'\r\n          rightPreviousTimestamp = timestamp\r\n          rightAnimation = window.requestAnimationFrame(rightAnimate)\r\n        }\r\n      }\r\n      let leftAnimate = function (timestamp) {\r\n        //移动速度(px/ms)\r\n        let speed = ((vm.bpm * timeInterval) / 60000) * vm.beatWidth\r\n        if (!leftStartTimestamp) {\r\n          leftStartTimestamp = timestamp\r\n          leftPreviousTimestamp = timestamp\r\n        }\r\n        let elapsed = timestamp - leftStartTimestamp\r\n        //判断是否需要演奏音符\r\n        if (\r\n          vm.leftSwitch &&\r\n          leftLastBeatIndex < Math.floor(elapsed / (60000 / vm.bpm))\r\n        ) {\r\n          //演奏\r\n          leftLastBeatIndex++\r\n\r\n          vm.playSingleBeat(\r\n            vm.left[Math.floor(leftLastBeatIndex / vm.barSize)][\r\n              leftLastBeatIndex % vm.barSize\r\n            ]\r\n          )\r\n        }\r\n        if (\r\n          !(vm.leftBeatOffset <= -(vm.left.flat(2).length - 1) * vm.beatWidth)\r\n        ) {\r\n          vm.leftBeatOffset =\r\n            vm.leftBeatOffset - speed * (timestamp - leftPreviousTimestamp)\r\n          vm.$refs.leftDiv.style.left = vm.leftBeatOffset + 'px'\r\n          leftPreviousTimestamp = timestamp\r\n          leftAnimation = window.requestAnimationFrame(leftAnimate)\r\n        }\r\n      }\r\n\r\n      window.requestAnimationFrame(rightAnimate)\r\n      window.requestAnimationFrame(leftAnimate)\r\n      vm.running = true\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n.window {\r\n  width: 80%;\r\n  height: 200px;\r\n  display: inline-block;\r\n  overflow: hidden;\r\n  box-shadow: inset -1px 0px 6px 1px #e7e7e7;\r\n}\r\n\r\n.right,\r\n.left {\r\n  height: 100px;\r\n  white-space: nowrap;\r\n  position: relative;\r\n}\r\n\r\n.left {\r\n  left: 40px;\r\n}\r\n\r\n.bar {\r\n  display: inline-block;\r\n  height: 100px;\r\n}\r\n\r\n.beat {\r\n  display: inline-block;\r\n  height: 100px;\r\n  line-height: 100px;\r\n  width: 80px;\r\n  color: white;\r\n  background-color: #3367d6;\r\n  box-shadow: -2px 3px 10px 2px #1e3d80;\r\n}\r\n\r\n.used {\r\n  background-color: #8bc97c;\r\n  color: white;\r\n  box-shadow: none;\r\n}\r\n\r\n.disabled {\r\n  filter: grayscale(1);\r\n}\r\n\r\n.left-label {\r\n  display: inline-block;\r\n  position: relative;\r\n  left: -30px;\r\n  top: -47px;\r\n}\r\n\r\n.right-label {\r\n  display: inline-block;\r\n  position: relative;\r\n  left: -15px;\r\n  top: -146px;\r\n}\r\n</style>\r\n\r\n","/**\r\n * 每个数组的第一层次是小节，每小节的字符串是拍子，拍子中如果两个数字连起来\r\n *  意味着连打\r\n */\r\nconst yellow = {\r\n  right: [\r\n    ['1 1', '1 1', '1 1', '1 1'], ['1 1', '1 1', '1 1', '1 1'],\r\n    ['1 0', '1 0', '1 0', '1 0'], ['1 0', '1 0', '1 0', '1 0'],\r\n    ['1 0', '1 0', '1 0', '1 0'], ['1 0', '1 0', '1 0', '1 0'],\r\n    ['1 0', '1 0', '1 0', '1 0'], ['1 0', '1 0', '1 0', '1 0'],\r\n    ['1 0', '1 2', '1 2', '1 2'], ['1 2', '1 2', '1 2', '1 22'],\r\n  ],\r\n  left: [\r\n    ['0 0', '0 0', '0 0', '0 0'], ['0 0', '0 0', '0 0', '0 0'],\r\n    ['0 0', '0 0', '0 0', '0 0'], ['0 0', '0 0', '0 0', '0 0'],\r\n    ['0 0', '0 0', '0 0', '0 0'], ['0 0', '0 0', '0 0', '0 0'],\r\n    ['0 0', '0 0', '0 0', '0 0'], ['0 0', '0 0', '0 0', '0 0'],\r\n    ['0 0', '0 2', '0 2', '2 2'], ['0 0', '0 2', '2 2', '2 2 2'],\r\n\r\n  ],\r\n  bpm: 118\r\n}\r\nexport { yellow }","import { render } from \"./PenbeatPlayer.vue?vue&type=template&id=2f019e15&scoped=true\"\nimport script from \"./PenbeatPlayer.vue?vue&type=script&lang=js\"\nexport * from \"./PenbeatPlayer.vue?vue&type=script&lang=js\"\n\nimport \"./PenbeatPlayer.vue?vue&type=style&index=0&id=2f019e15&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\workspace\\\\playground\\\\estiag\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2f019e15\"]])\n\nexport default __exports__"],"names":["id","class","_createElementVNode","for","_createElementBlock","_hoisted_4","_hoisted_5","disabled","_ctx","ref","_Fragment","_renderList","bar","indexBar","key","beat","indexBeat","used","$options","onClick","type","value","$event","_hoisted_9","_hoisted_10","_hoisted_11","yellow","right","left","bpm","timeInterval","musicBar","rightAnimation","leftAnimation","beatWidth","audioContext","window","AudioContext","webkitAudioContext","gainNode","createGain","gain","data","leftSwitch","rightSwitch","metronomeSwtich","leftBeatOffset","rightBeatOffset","barSize","length","running","watch","computed","mounted","methods","isLeftUsed","index","Math","ceil","this","isRightUsed","playSingleBeat","vm","beats","split","duration","step","i","subBeatStep","j","subBeat","setTimeout","play0","play1","play2","play3","play4","playSinWave","frequency","oscillator","createOscillator","connect","destination","start","stop","cancelAnimationFrame","restart","$refs","rightDiv","style","leftDiv","play","leftStartTimestamp","rightStartTimestamp","leftPreviousTimestamp","rightPreviousTimestamp","leftLastBeatIndex","rightLastBeatIndex","rightAnimate","timestamp","speed","elapsed","floor","flat","requestAnimationFrame","leftAnimate","__exports__","render"],"sourceRoot":""}